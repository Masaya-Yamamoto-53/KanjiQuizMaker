# \# 漢字プリント作成ツール 仕様書（統合版）

# 

# \## 1. 生徒管理機能

# 

# \### 1.1 生徒登録

# \- 生徒名が未入力の場合、エラーダイアログ「名前を入力してください」を表示

# \- 重複登録不可：「既に登録済みです」と表示

# \- 登録成功時：生徒リストに追加 → 入力欄初期化 → 生徒選択欄に反映

# 

# \### 1.2 生徒選択

# \- コンボボックスで選択可能

# \- 選択時：削除ボタン・出題範囲・出題数・問題集選択ボタンを有効化

# 

# \### 1.3 生徒削除

# \- 削除ボタン押下時：「本当に削除しますか」確認ダイアログ表示

# \- 「はい」→ 削除実行、「いいえ」→ キャンセル

# \- 削除後：関連UIをすべて初期化・無効化

# 

# ---

# 

# \## 2. 問題集読み込み仕様

# 

# \### 2.1 ファイル形式

# \- CSV形式

# \- 必須列：学年、問題文、答え、番号、管理番号、最終更新日、結果、履歴

# 

# \### 2.2 読み込み判定

# \- 成功条件：

# &nbsp; - ファイルが空でない

# &nbsp; - 必須列が揃っている

# &nbsp; - 学年が1〜6の整数

# &nbsp; - 答えが漢字のみ

# &nbsp; - 問題文と答えの漢字数が一致

# \- 失敗時：レポート初期化／プリント・印刷ボタン無効化

# 

# ---

# 

# \## 3. 出題範囲選択機能

# 

# \- 小学1年〜6年のチェックボックスで複数選択可能

# \- 問題集の「学年」列に基づいて抽出

# \- 複数学年選択時：偏りを許容し、全体からランダム抽出

# 

# ---

# 

# \## 4. 出題数機能

# 

# \### 4.1 入力補正

# \- 1未満 → `1` に補正

# \- 20超 → `20` に補正

# \- 数値以外 → `20` に補正

# \- 有効値（1〜20） → 補正不要

# 

# \### 4.2 補正タイミング

# \- テキストボックスのフォーカスが外れた時に補正

# \- 補正後の値は即時反映（メッセージ表示なし）

# 

# ---

# 

# \## 5. プリント作成機能

# 

# \### 5.1 有効化条件（AND）

# \- 問題集が正常に読み込まれている

# \- 出題範囲が1つ以上選択されている

# \- 出題数が1〜20の範囲に収まっている

# 

# \### 5.2 無効化条件（OR）

# \- 問題集未選択／読み込み失敗

# \- 出題範囲未選択

# \- 出題数が無効

# 

# ---

# 

# \## 6. 印刷機能

# 

# \### 6.1 印刷対象の定義

# \- 生徒名入りPDFが生成済みであること

# \- PDF命名規則：生徒名 + `.pdf`（スペースは `\_` に置換）

# 

# \### 6.2 ボタン制御

# \- PDF存在時のみ印刷ボタンを有効化

# \- 未生成時は無効化

# 

# ---

# 

# \## 7. 採点機能

# 

# \### 7.1 UI構成

# \- 問題の答えを表示

# \- 結果列の状態を記号で表示（空欄: `－`, x: `×`, o: `○`, d: `D`, w: `W`, m: `M`）

# \- 採点ボタンは `○` または `×` のみ選択可能

# \- 一括操作：「全て○」「全て×」ボタンで全問題を設定

# \- 採点完了ボタン：結果列を更新し、履歴列に追記

# 

# \### 7.2 状態遷移（採点完了時）

# \- 正解：

# &nbsp; - 空欄 → `o`

# &nbsp; - `x` → `d`

# &nbsp; - `d` → `w`

# &nbsp; - `w` → `m`

# &nbsp; - `m` → `o`

# &nbsp; - `o` → `o`（変更なし）

# \- 不正解：

# &nbsp; - 任意の状態 → `x`

# 

# ---

# 

# \## 8. レポート機能

# 

# \### 8.1 更新トリガー

# \- 問題集読み込み成功 → 統計更新

# \- 問題集読み込み失敗 → レポート初期化

# \- 採点完了 → 問題集全体の結果列を再集計 → レポート即時更新

# 

# \### 8.2 統計項目

# 

# | 項目名       | 内容                                       |

# |--------------|--------------------------------------------|

# | ① 出題状況   | 分子：採点完了済みの問題数<br>分母：学年別全問題数 |

# | ② 正解       | 結果列が `o` の件数                        |

# | ③ 不正解     | 結果列が `x` の件数                        |

# | ④ 一日後     | 結果列が `d` の件数                        |

# | ⑤ 一週間後   | 結果列が `w` の件数                        |

# | ⑥ 一ヶ月後   | 結果列が `m` の件数                        |

# | 合計         | ①〜⑥の合算（分母は別途表示）               |

# 

# \### 8.3 履歴列

# \- 採点結果（○／×）を履歴列に末尾追加（例：`xooxo`）

# \- 活用方針は未定（将来的な分析に活用可能）

# 

# ---

# 

